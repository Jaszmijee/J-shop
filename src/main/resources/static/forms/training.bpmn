<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_0gkcpwf" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.9.0" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.18.0">
  <bpmn:process id="Shopping" name="shopping" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_1mjfeq7</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_1mjfeq7" sourceRef="StartEvent_1" targetRef="provideValues">
      <bpmn:extensionElements />
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_19jxyo7" name="add to cart" sourceRef="provideValues" targetRef="Activity_160el9l">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${activity == "addToCart"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="provideValues" name="provide values">
      <bpmn:extensionElements />
      <bpmn:incoming>Flow_1mjfeq7</bpmn:incoming>
      <bpmn:incoming>Flow_0fft9fv</bpmn:incoming>
      <bpmn:incoming>Flow_0w3po7f</bpmn:incoming>
      <bpmn:outgoing>Flow_19jxyo7</bpmn:outgoing>
      <bpmn:outgoing>Flow_0cnsne1</bpmn:outgoing>
      <bpmn:outgoing>Flow_1l075xz</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="Activity_160el9l" name="addToCart" camunda:class="com.example.jshop.camunda.serviceTasks.AddToCartDelegate">
      <bpmn:incoming>Flow_19jxyo7</bpmn:incoming>
      <bpmn:outgoing>Flow_0fft9fv</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0fft9fv" sourceRef="Activity_160el9l" targetRef="provideValues" />
    <bpmn:sequenceFlow id="Flow_0cnsne1" name="finalize cart" sourceRef="provideValues" targetRef="Gateway_0af3b54">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${activity == "finalizeCart"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1l075xz" name="remove from cart" sourceRef="provideValues" targetRef="Activity_1235hfx">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${activity == "removeFromCart"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0w3po7f" sourceRef="Activity_1235hfx" targetRef="provideValues" />
    <bpmn:serviceTask id="Activity_1235hfx" name="removeFromCart" camunda:class="com.example.jshop.camunda.serviceTasks.RemoveFromCartDelegate">
      <bpmn:incoming>Flow_1l075xz</bpmn:incoming>
      <bpmn:outgoing>Flow_0w3po7f</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_0af3b54" name="authenticated?" default="Flow_1x2uzs3">
      <bpmn:incoming>Flow_0cnsne1</bpmn:incoming>
      <bpmn:outgoing>Flow_0ffu51c</bpmn:outgoing>
      <bpmn:outgoing>Flow_1x2uzs3</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0ffu51c" name="yes" sourceRef="Gateway_0af3b54" targetRef="Activity_0nhvya9">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${authenticated == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:endEvent id="Event_1isj6ui" name="order completed">
      <bpmn:incoming>Flow_07q96a7</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1x2uzs3" sourceRef="Gateway_0af3b54" targetRef="Activity_1pu81wc" />
    <bpmn:userTask id="Activity_0nhvya9" name="log-in">
      <bpmn:incoming>Flow_0ffu51c</bpmn:incoming>
      <bpmn:outgoing>Flow_0ma3ugg</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0ma3ugg" sourceRef="Activity_0nhvya9" targetRef="Activity_030mi1v" />
    <bpmn:sequenceFlow id="Flow_1emzqg9" sourceRef="Activity_1pu81wc" targetRef="Activity_174r7fp" />
    <bpmn:userTask id="Activity_1pu81wc" name="provide data">
      <bpmn:incoming>Flow_1x2uzs3</bpmn:incoming>
      <bpmn:outgoing>Flow_1emzqg9</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_1kiv8mn" sourceRef="Activity_030mi1v" targetRef="Activity_1nmx5uo" />
    <bpmn:serviceTask id="Activity_030mi1v" name="finalize order" camunda:class="com.example.jshop.camunda.serviceTasks.FinalizeCartAuthenticatedDelegate">
      <bpmn:incoming>Flow_0ma3ugg</bpmn:incoming>
      <bpmn:outgoing>Flow_1kiv8mn</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_07q96a7" sourceRef="Activity_174r7fp" targetRef="Event_1isj6ui" />
    <bpmn:serviceTask id="Activity_174r7fp" name="finalize and pay for order" camunda:class="com.example.jshop.camunda.serviceTasks.FinalizeAndPayUnauthenticatedDelegate">
      <bpmn:incoming>Flow_1emzqg9</bpmn:incoming>
      <bpmn:outgoing>Flow_07q96a7</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="Activity_1nmx5uo" name="choose next action">
      <bpmn:incoming>Flow_1kiv8mn</bpmn:incoming>
      <bpmn:outgoing>Flow_0t1k4xe</bpmn:outgoing>
      <bpmn:outgoing>Flow_1i4d100</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0t1k4xe" name="cancel order" sourceRef="Activity_1nmx5uo" targetRef="Activity_1vewf4t">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${activity == "cancelOrder"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:serviceTask id="Activity_1vewf4t" name="cancel order" camunda:class="com.example.jshop.camunda.serviceTasks.CancelOrderDelegate">
      <bpmn:incoming>Flow_0t1k4xe</bpmn:incoming>
      <bpmn:outgoing>Flow_0v2jekv</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="Event_0tuixkc" name="order cancelled">
      <bpmn:incoming>Flow_0v2jekv</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0v2jekv" sourceRef="Activity_1vewf4t" targetRef="Event_0tuixkc" />
    <bpmn:sequenceFlow id="Flow_1i4d100" name="pay for order" sourceRef="Activity_1nmx5uo" targetRef="Activity_1fua907">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${activity == "payForOrder"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:endEvent id="Event_0p69bo7" name="order completed">
      <bpmn:incoming>Flow_0vciazk</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0vciazk" sourceRef="Activity_1fua907" targetRef="Event_0p69bo7" />
    <bpmn:serviceTask id="Activity_1fua907" name="pay for order" camunda:class="com.example.jshop.camunda.serviceTasks.PayForOrderAuthenticatedDelegate">
      <bpmn:incoming>Flow_1i4d100</bpmn:incoming>
      <bpmn:outgoing>Flow_0vciazk</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_10vvwky" sourceRef="Event_0pxaaw4" targetRef="Activity_18c672h" />
    <bpmn:endEvent id="Event_03rten7" name="carts removed">
      <bpmn:incoming>Flow_06azjqt</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_06azjqt" sourceRef="Activity_18c672h" targetRef="Event_03rten7" />
    <bpmn:serviceTask id="Activity_18c672h" name="remove cart" camunda:class="com.example.jshop.camunda.serviceTasks.RemoveNotFinalizedCartsDelegate">
      <bpmn:incoming>Flow_10vvwky</bpmn:incoming>
      <bpmn:outgoing>Flow_06azjqt</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:boundaryEvent id="Event_0pxaaw4" camunda:asyncBefore="true" attachedToRef="provideValues">
      <bpmn:outgoing>Flow_10vvwky</bpmn:outgoing>
      <bpmn:timerEventDefinition id="TimerEventDefinition_1ikty80">
        <bpmn:timeDuration xsi:type="bpmn:tFormalExpression">PT5M</bpmn:timeDuration>
      </bpmn:timerEventDefinition>
    </bpmn:boundaryEvent>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Shopping">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="222" y="542" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1t82dqg_di" bpmnElement="provideValues">
        <dc:Bounds x="310" y="520" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_14sl7yc_di" bpmnElement="Activity_160el9l">
        <dc:Bounds x="550" y="80" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0uyylzc_di" bpmnElement="Activity_1235hfx">
        <dc:Bounds x="550" y="980" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0af3b54_di" bpmnElement="Gateway_0af3b54" isMarkerVisible="true">
        <dc:Bounds x="595" y="535" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="653" y="553" width="73" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1isj6ui_di" bpmnElement="Event_1isj6ui">
        <dc:Bounds x="1582" y="812" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1560" y="855" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0tiqb9o_di" bpmnElement="Activity_0nhvya9">
        <dc:Bounds x="680" y="270" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_04gu0lj_di" bpmnElement="Activity_1pu81wc">
        <dc:Bounds x="680" y="790" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1dii60z_di" bpmnElement="Activity_030mi1v">
        <dc:Bounds x="840" y="270" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1m9bj2x_di" bpmnElement="Activity_174r7fp">
        <dc:Bounds x="840" y="790" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0urz368_di" bpmnElement="Activity_1nmx5uo">
        <dc:Bounds x="1000" y="270" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1k8urxv_di" bpmnElement="Activity_1vewf4t">
        <dc:Bounds x="1000" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0tuixkc_di" bpmnElement="Event_0tuixkc">
        <dc:Bounds x="1252" y="522" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1232" y="565" width="76" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0p69bo7_di" bpmnElement="Event_0p69bo7">
        <dc:Bounds x="1572" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1550" y="145" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0z661uf_di" bpmnElement="Activity_1fua907">
        <dc:Bounds x="1000" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_03rten7_di" bpmnElement="Event_03rten7">
        <dc:Bounds x="192" y="812" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="175" y="855" width="70" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1tcv3to_di" bpmnElement="Activity_18c672h">
        <dc:Bounds x="160" y="670" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0xcfbn0_di" bpmnElement="Event_0pxaaw4">
        <dc:Bounds x="292" y="582" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1mjfeq7_di" bpmnElement="Flow_1mjfeq7">
        <di:waypoint x="258" y="560" />
        <di:waypoint x="310" y="560" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_19jxyo7_di" bpmnElement="Flow_19jxyo7">
        <di:waypoint x="410" y="540" />
        <di:waypoint x="480" y="540" />
        <di:waypoint x="480" y="120" />
        <di:waypoint x="550" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="418" y="484" width="53" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fft9fv_di" bpmnElement="Flow_0fft9fv">
        <di:waypoint x="560" y="80" />
        <di:waypoint x="360" y="80" />
        <di:waypoint x="360" y="520" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0cnsne1_di" bpmnElement="Flow_0cnsne1">
        <di:waypoint x="410" y="560" />
        <di:waypoint x="595" y="560" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="512" y="542" width="56" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1l075xz_di" bpmnElement="Flow_1l075xz">
        <di:waypoint x="410" y="590" />
        <di:waypoint x="480" y="590" />
        <di:waypoint x="480" y="1020" />
        <di:waypoint x="550" y="1020" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="388" y="623" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0w3po7f_di" bpmnElement="Flow_0w3po7f">
        <di:waypoint x="560" y="1060" />
        <di:waypoint x="360" y="1060" />
        <di:waypoint x="360" y="600" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ffu51c_di" bpmnElement="Flow_0ffu51c">
        <di:waypoint x="620" y="535" />
        <di:waypoint x="620" y="310" />
        <di:waypoint x="680" y="310" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="626" y="489" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1x2uzs3_di" bpmnElement="Flow_1x2uzs3">
        <di:waypoint x="620" y="585" />
        <di:waypoint x="620" y="830" />
        <di:waypoint x="680" y="830" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ma3ugg_di" bpmnElement="Flow_0ma3ugg">
        <di:waypoint x="780" y="310" />
        <di:waypoint x="840" y="310" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1emzqg9_di" bpmnElement="Flow_1emzqg9">
        <di:waypoint x="780" y="830" />
        <di:waypoint x="840" y="830" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1kiv8mn_di" bpmnElement="Flow_1kiv8mn">
        <di:waypoint x="940" y="310" />
        <di:waypoint x="1000" y="310" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_07q96a7_di" bpmnElement="Flow_07q96a7">
        <di:waypoint x="940" y="830" />
        <di:waypoint x="1582" y="830" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0t1k4xe_di" bpmnElement="Flow_0t1k4xe">
        <di:waypoint x="1050" y="350" />
        <di:waypoint x="1050" y="500" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="979" y="407" width="61" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0v2jekv_di" bpmnElement="Flow_0v2jekv">
        <di:waypoint x="1100" y="540" />
        <di:waypoint x="1252" y="540" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1i4d100_di" bpmnElement="Flow_1i4d100">
        <di:waypoint x="1050" y="270" />
        <di:waypoint x="1050" y="160" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="978" y="241" width="63" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vciazk_di" bpmnElement="Flow_0vciazk">
        <di:waypoint x="1100" y="120" />
        <di:waypoint x="1572" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10vvwky_di" bpmnElement="Flow_10vvwky">
        <di:waypoint x="310" y="618" />
        <di:waypoint x="310" y="710" />
        <di:waypoint x="260" y="710" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06azjqt_di" bpmnElement="Flow_06azjqt">
        <di:waypoint x="210" y="750" />
        <di:waypoint x="210" y="812" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
